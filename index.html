<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pollsplane Management Interface</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Select2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" rel="stylesheet" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- API Key Validation Screen -->
    <div id="apiKeyScreen" class="login-overlay">
        <div class="login-container">
            <div class="login-header">
                <h2>Sign In</h2>
                <div class="theme-toggle">
                    <span>Dark Mode</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="form-group">
                <label for="apiKey">API Key</label>
                <div class="input-wrapper">
                    <input type="password" id="apiKey" placeholder="Enter your API key">
                    <button id="toggleApiKeyVisibility" class="toggle-password">
                        <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <button id="loginBtn" class="login-button">
                Sign In
            </button>
        </div>
    </div>

    <!-- Main Content (initially hidden) -->
    <div id="mainContent" class="hidden w-full">

    <div class="container mx-auto px-4 max-w-7xl w-full">
        <!-- Main Header Card -->
        <div class="header-card">
            <h1 class="text-2xl font-bold text-gray-900 mb-0">Pollsplane Admin Interface</h1>
            <div class="header-controls">
                <div class="theme-toggle">
                    <span>Dark Mode</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="slider"></span>
                    </label>
                </div>
                <button id="signOutBtn" class="sign-out-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V5.414l6.293 6.293a1 1 0 001.414-1.414L5.414 4H17a1 1 0 100-2H3z" clip-rule="evenodd" />
                    </svg>
                    Sign Out
                </button>
            </div>
        </div>

<!-- Poll Selector -->
        <div class="mb-8 p-6 bg-indigo-50 rounded-lg border border-indigo-200">
            <h2 class="section-header text-indigo-700">Poll Management</h2>
            <div class="input-group">
                <label for="pollSelector" class="text-gray-700">Choose Poll:</label>
                <select id="pollSelector" class="w-full select2">
                    <option value="">-- Select a Poll --</option>
                </select>
                <button id="loadPollsBtn" class="btn btn-secondary">Load Polls</button>
            </div>
            <div class="input-group">
                <label for="pollId" class="text-gray-700">Selected ID:</label>
                <input type="text" id="pollId" class="w-full" placeholder="Poll ID (auto-filled or type manually)">
            </div>
            <button id="fetchPollDetailsBtn" class="btn btn-primary w-full mt-4">Refetch Details for Selected Poll</button>
            <button id="deletePollBtn" class="btn btn-danger w-full mt-2">Delete Selected Poll</button>
        </div>

        <div id="pollDetailsSection" class="hidden">

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <!-- Update Poll Note -->
            <div class="p-6 bg-green-50 rounded-lg border border-green-200">
                <h2 class="section-header text-green-700">Update Poll Note</h2>
                <div class="input-group">
                    <label for="pollNote" class="text-gray-700">Note:</label>
                    <textarea id="pollNote" rows="3" class="w-full" placeholder="Enter note for the poll"></textarea>
                </div>
                <button id="updateNoteBtn" class="btn btn-primary w-full">Update Note</button>
            </div>

            <!-- Update Poll Associations -->
            <div class="p-6 bg-purple-50 rounded-lg border border-purple-200">
                <h2 class="section-header text-purple-700">Update Associations</h2>
                <div class="input-group">
                    <label for="youtubeId" class="text-gray-700">YouTube ID:</label>
                    <input type="text" id="youtubeId" class="w-full" placeholder="YouTube Video ID (or leave blank to clear)">
                </div>
                <div class="input-group">
                    <label for="floatplaneId" class="text-gray-700">Floatplane ID:</label>
                    <input type="text" id="floatplaneId" class="w-full" placeholder="Floatplane Post ID (or leave blank to clear)">
                </div>
                <button id="updateAssociationsBtn" class="btn btn-primary w-full">Update Associations</button>
            </div>
        </div>



        <!-- Update Untracked Status -->
        <div class="mb-8 p-6 bg-red-50 rounded-lg border border-red-200">
            <h2 class="section-header text-red-700">Update Untracked Status</h2>
            <div class="input-group items-center">
                <label for="untrackedCheckbox" class="text-gray-700">Untracked:</label>
                <input type="checkbox" id="untrackedCheckbox" class="h-5 w-5 text-red-600 rounded focus:ring-red-500">
                <span class="text-sm text-gray-500 ml-2">Indicates potential data collection issues.</span>
            </div>
            <button id="updateUntrackedBtn" class="btn btn-primary w-full">Update Untracked Status</button>
        </div>

    </div>



        <!-- Create New Poll -->
        <div class="mb-8 p-6 bg-yellow-50 rounded-lg border border-yellow-200">
            <h2 class="section-header text-yellow-700">Create New Poll</h2>
            <div class="input-group">
                <label for="newPollTitle" class="text-gray-700">Title:</label>
                <input type="text" id="newPollTitle" class="w-full" placeholder="Poll Title">
            </div>
            <div class="input-group">
                <label for="newPollCreatorId" class="text-gray-700">Creator ID:</label>
                <input type="text" id="newPollCreatorId" class="w-full" placeholder="Creator ID (e.g., 686c49c403ee2657d069c916)">
            </div>
            <div class="input-group">
                <label for="newPollStartDate" class="text-gray-700">Start Date:</label>
                <input type="text" id="newPollStartDate" class="w-full" placeholder="ISO 8601 (e.g., 2023-01-01T00:00:00Z)">
            </div>
            <div class="input-group">
                <label for="newPollEndDate" class="text-gray-700">End Date:</label>
                <input type="text" id="newPollEndDate" class="w-full" placeholder="ISO 8601 (optional)">
            </div>
            <div class="input-group">
                <label for="newPollOptions" class="text-gray-700">Options:</label>
                <textarea id="newPollOptions" rows="3" class="w-full" placeholder="Comma-separated options (e.g., Option A, Option B)"></textarea>
            </div>
            <button id="createPollBtn" class="btn btn-primary w-full">Create Poll</button>
        </div>

        <!-- Creator Management -->
        <div class="mb-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
            <h2 class="section-header text-gray-700">Creator Management</h2>
            <div class="input-group">
                <label for="creatorSelector" class="text-gray-700">Choose Creator:</label>
                <select id="creatorSelector" class="w-full searchable">
                    <option value="">-- Select a Creator --</option>
                </select>
                <button id="loadCreatorsBtn" class="btn btn-secondary">Load Creators</button>
            </div>
            <div class="input-group">
                <label for="creatorId" class="text-gray-700">Selected ID:</label>
                <input type="text" id="creatorId" class="w-full" placeholder="Creator ID (auto-filled or type manually)">
            </div>
            <button id="fetchCreatorDetailsBtn" class="btn btn-primary w-full mt-4">Fetch Details for Selected Creator</button>
            
            <div class="mt-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Update Creator Status</h3>
                <div class="input-group items-center">
                    <label for="creatorUnlistedCheckbox" class="text-gray-700">Unlisted:</label>
                    <input type="checkbox" id="creatorUnlistedCheckbox" class="h-5 w-5 text-gray-600 rounded focus:ring-gray-500">
                    <span class="text-sm text-gray-500 ml-2">Hide creator from public listings.</span>
                </div>
                <div class="input-group items-center">
                    <label for="creatorRemovedCheckbox" class="text-gray-700">Removed:</label>
                    <input type="checkbox" id="creatorRemovedCheckbox" class="h-5 w-5 text-red-600 rounded focus:ring-red-500">
                    <span class="text-sm text-gray-500 ml-2">Mark creator as removed.</span>
                </div>
                <button id="updateCreatorStatusBtn" class="btn btn-primary w-full">Update Creator Status</button>
            </div>

            <div class="mt-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">Creator Channels</h3>
                <div id="creatorChannelsList" class="mb-4">
                    <!-- Channels will be dynamically loaded here -->
                    <p class="text-sm text-gray-500">No channels loaded.</p>
                </div>
                <h4 class="text-md font-semibold text-gray-700 mb-2">Add New Channel</h4>
                <div class="input-group">
                    <label for="newChannelTitle" class="text-gray-700">Title:</label>
                    <input type="text" id="newChannelTitle" class="w-full" placeholder="Channel Title">
                </div>
                <div class="input-group">
                    <label for="newChannelDescription" class="text-gray-700">Description:</label>
                    <textarea id="newChannelDescription" rows="2" class="w-full" placeholder="Channel Description (optional)"></textarea>
                </div>
                <div class="input-group">
                    <label for="newChannelThumbnail" class="text-gray-700">Thumbnail URL:</label>
                    <input type="url" id="newChannelThumbnail" class="w-full" placeholder="Thumbnail Image URL (optional)">
                </div>
                <button id="addChannelBtn" class="btn btn-primary w-full mb-4">Add Channel</button>

                <h4 class="text-md font-semibold text-gray-700 mb-2">Update Existing Channel</h4>
                <div class="input-group">
                    <label for="updateChannelOldTitle" class="text-gray-700">Old Title:</label>
                    <input type="text" id="updateChannelOldTitle" class="w-full" placeholder="Channel Title to Update">
                </div>
                <div class="input-group">
                    <label for="updateChannelNewTitle" class="text-gray-700">New Title:</label>
                    <input type="text" id="updateChannelNewTitle" class="w-full" placeholder="New Channel Title">
                </div>
                <div class="input-group">
                    <label for="updateChannelDescription" class="text-gray-700">Description:</label>
                    <textarea id="updateChannelDescription" rows="2" class="w-full" placeholder="New Channel Description (optional)"></textarea>
                </div>
                <div class="input-group">
                    <label for="updateChannelThumbnail" class="text-gray-700">Thumbnail URL:</label>
                    <input type="url" id="updateChannelThumbnail" class="w-full" placeholder="New Thumbnail Image URL (optional)">
                </div>
                <button id="updateChannelBtn" class="btn btn-primary w-full mb-4">Update Channel</button>

                <h4 class="text-md font-semibold text-gray-700 mb-2">Remove Channel</h4>
                <div class="input-group">
                    <label for="removeChannelTitle" class="text-gray-700">Channel Title:</label>
                    <input type="text" id="removeChannelTitle" class="w-full" placeholder="Title of Channel to Remove">
                </div>
                <button id="removeChannelBtn" class="btn btn-danger w-full">Remove Channel</button>
            </div>
        </div>


        <!-- API Key Management -->
        <div class="mb-8 p-6 bg-blue-100 rounded-lg border border-blue-300">
            <h2 class="section-header text-blue-800">API Key Management</h2>
            <button id="listApiKeysBtn" class="btn btn-secondary w-full mb-4">List All API Keys</button>

            <h3 class="text-lg font-semibold text-gray-700 mb-2">Create New API Key</h3>
            <div class="input-group items-center">
                <label for="newApiKeyPermissionManagement" class="text-gray-700">Management:</label>
                <input type="checkbox" id="newApiKeyPermissionManagement" class="h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                <span class="text-sm text-gray-500 ml-2">Allow API key to manage polls and creators.</span>
            </div>
            <div class="input-group items-center">
                <label for="newApiKeyPermissionSeeUnlisted" class="text-gray-700">See Unlisted:</label>
                <input type="checkbox" id="newApiKeyPermissionSeeUnlisted" class="h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                <span class="text-sm text-gray-500 ml-2">Allow API key to see unlisted polls/creators.</span>
            </div>
            <div class="input-group">
                <label for="newApiKeyRateLimitCount" class="text-gray-700">Rate Limit Count:</label>
                <input type="number" id="newApiKeyRateLimitCount" class="w-full" value="100" min="1">
            </div>
            <div class="input-group">
                <label for="newApiKeyRateLimitPeriod" class="text-gray-700">Rate Limit Period (s):</label>
                <input type="number" id="newApiKeyRateLimitPeriod" class="w-full" value="60" min="1">
            </div>
            <button id="createApiKeyBtn" class="btn btn-primary w-full mb-4">Create API Key</button>

            <h3 class="text-lg font-semibold text-gray-700 mb-2">Delete API Key</h3>
            <div class="input-group">
                <label for="deleteApiKeyInput" class="text-gray-700">API Key to Delete:</label>
                <input type="text" id="deleteApiKeyInput" class="w-full" placeholder="Enter API Key to delete">
            </div>
            <button id="deleteApiKeyBtn" class="btn btn-danger w-full mb-4">Delete API Key</button>

            <h3 class="text-lg font-semibold text-gray-700 mb-2">Update API Key</h3>
            <div class="input-group">
                <label for="updateApiKeyInput" class="text-gray-700">API Key to Update:</label>
                <input type="text" id="updateApiKeyInput" class="w-full" placeholder="Enter API Key to update">
            </div>
            <div class="input-group items-center">
                <label for="updateApiKeyPermissionManagement" class="text-gray-700">Management:</label>
                <input type="checkbox" id="updateApiKeyPermissionManagement" class="h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                <span class="text-sm text-gray-500 ml-2">Allow API key to manage polls and creators.</span>
            </div>
            <div class="input-group items-center">
                <label for="updateApiKeyPermissionSeeUnlisted" class="text-gray-700">See Unlisted:</label>
                <input type="checkbox" id="updateApiKeyPermissionSeeUnlisted" class="h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                <span class="text-sm text-gray-500 ml-2">Allow API key to see unlisted polls/creators.</span>
            </div>
            <div class="input-group">
                <label for="updateApiKeyRateLimitCount" class="text-gray-700">New Rate Limit Count:</label>
                <input type="number" id="updateApiKeyRateLimitCount" class="w-full" value="100" min="1">
            </div>
            <div class="input-group">
                <label for="updateApiKeyRateLimitPeriod" class="text-gray-700">New Rate Limit Period (s):</label>
                <input type="number" id="updateApiKeyRateLimitPeriod" class="w-full" value="60" min="1">
            </div>
            <button id="updateApiKeyBtn" class="btn btn-primary w-full">Update API Key</button>
        </div>


        <div class="response-section mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">API Response</h2>
            <div class="response-wrapper">
                <div class="response-area" id="apiResponse"></div>
                <div class="response-controls">
                    <button id="copyResponseBtn" class="copy-btn">Copy Response</button>
                    <div id="loadingSpinner" class="loading-spinner"></div>
                </div>
            </div>
        </div>
    </div>

    </div>
    <div id="messageBox" class="message-box"></div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Select2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <!-- Main JavaScript -->
    <script src="js/app.js"></script>
</body>
</html>
